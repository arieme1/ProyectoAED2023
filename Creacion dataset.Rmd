---
title: "Prueba_importaciondatos"
author: "Mar Riveiro Cabado"
date: "2023-11-02"
output: html_document
---


```{r}
library(dplyr)
library(tidyr)
library(readr)
```


```{r}
estaciones <- read_delim("data/Maestro_Climatologico_2022.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE,show_col_types = FALSE)
```


```{r}
ruta_carpeta<-"data/Variables"
archivos_climaticos <- list.files(ruta_carpeta,pattern = ".*.csv")
archivos_climaticos
```


```{r}
datos<-data.frame(Indicativo=estaciones$INDICATIVO)
for (archivo in archivos_climaticos) {
  
    ruta_completa_archivo<-file.path(ruta_carpeta,archivo)
    
    variable <-read_delim(ruta_completa_archivo, delim = ";", escape_double = FALSE, trim_ws=TRUE, show_col_types=FALSE)
    
  prefijo <- substr(archivo, 1, 2)
  
  colnames(variable)[-1] <- paste(prefijo, colnames(variable)[-1], sep = "_")
    
  #colnames(variable)[-1] <- paste("p_", colnames(variable)[-1], sep = "")
  datos_variable<-as.data.frame(variable) 
  datos<-merge(datos,datos_variable, by="Indicativo", sort=FALSE,all.x = TRUE, all.y = TRUE)
}
```


