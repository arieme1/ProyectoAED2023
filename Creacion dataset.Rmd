---
title: "Prueba_importaciondatos"
author: "Mar Riveiro Cabado"
date: "2023-11-02"
output: html_document
---


```{r}
library(dplyr)
library(tidyr)
library(readr)
```


```{r}
estaciones <- read_delim("data/Maestro_Climatologico_2022.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE,show_col_types = FALSE)
```


```{r}
ruta_carpeta<-"data/Variables/2022"
archivos_climaticos <- list.files(ruta_carpeta,pattern = ".*.csv")
archivos_climaticos
```


```{r}
datos_2022<-data.frame(Indicativo=estaciones$INDICATIVO)
for (archivo in archivos_climaticos) {
  
    ruta_completa_archivo<-file.path(ruta_carpeta,archivo)
    
    variable <-read_delim(ruta_completa_archivo, delim = ";", escape_double = FALSE, trim_ws=TRUE, show_col_types=FALSE)
    
  prefijo <- substr(archivo, 1, 2)
  
  colnames(variable)[-1] <- paste(prefijo, colnames(variable)[-1], sep = "_")
    
  #colnames(variable)[-1] <- paste("p_", colnames(variable)[-1], sep = "")
  datos_variable<-as.data.frame(variable) 
  datos_2022<-merge(datos_2022,datos_variable, by="Indicativo", sort=FALSE,all.x = TRUE, all.y = TRUE)

}
```


```{r}
ruta_carpeta<-"data/Variables/2021"
archivos_climaticos <- list.files(ruta_carpeta,pattern = ".*.csv")

datos_2021<-data.frame(Indicativo=estaciones$INDICATIVO)
for (archivo in archivos_climaticos) {
  
    ruta_completa_archivo<-file.path(ruta_carpeta,archivo)
    
    variable <-read_delim(ruta_completa_archivo, delim = ";", escape_double = FALSE, trim_ws=TRUE, show_col_types=FALSE)
    
  prefijo <- substr(archivo, 1, 2)
  
  colnames(variable)[-1] <- paste(prefijo, colnames(variable)[-1], sep = "_")
    
  #colnames(variable)[-1] <- paste("p_", colnames(variable)[-1], sep = "")
  datos_variable<-as.data.frame(variable) 
  datos_2021<-merge(datos_2021,datos_variable, by="Indicativo", sort=FALSE,all.x = TRUE, all.y = TRUE)
}
```

```{r}
ruta_carpeta<-"data/Variables/2020"
archivos_climaticos <- list.files(ruta_carpeta,pattern = ".*.csv")

datos_2020<-data.frame(Indicativo=estaciones$INDICATIVO)
for (archivo in archivos_climaticos) {
  
    ruta_completa_archivo<-file.path(ruta_carpeta,archivo)
    
    variable <-read_delim(ruta_completa_archivo, delim = ";", escape_double = FALSE, trim_ws=TRUE, show_col_types=FALSE)
    
  prefijo <- substr(archivo, 1, 2)
  
  colnames(variable)[-1] <- paste(prefijo, colnames(variable)[-1], sep = "_")
    
  #colnames(variable)[-1] <- paste("p_", colnames(variable)[-1], sep = "")
  datos_variable<-as.data.frame(variable) 
  datos_2020<-merge(datos_2020,datos_variable, by="Indicativo", sort=FALSE,all.x = TRUE, all.y = TRUE)
}
```

```{r}
ruta_carpeta<-"data/Variables/2019"
archivos_climaticos <- list.files(ruta_carpeta,pattern = ".*.csv")

datos_2019<-data.frame(Indicativo=estaciones$INDICATIVO)
for (archivo in archivos_climaticos) {
  
    ruta_completa_archivo<-file.path(ruta_carpeta,archivo)
    
    variable <-read_delim(ruta_completa_archivo, delim = ";", escape_double = FALSE, trim_ws=TRUE, show_col_types=FALSE)
    
  prefijo <- substr(archivo, 1, 2)
  
  colnames(variable)[-1] <- paste(prefijo, colnames(variable)[-1], sep = "_")
    
  #colnames(variable)[-1] <- paste("p_", colnames(variable)[-1], sep = "")
  datos_variable<-as.data.frame(variable) 
  datos_2019<-merge(datos_2019,datos_variable, by="Indicativo", sort=FALSE,all.x = TRUE, all.y = TRUE)
}
```

```{r}
ruta_carpeta<-"data/Variables/2018"
archivos_climaticos <- list.files(ruta_carpeta,pattern = ".*.csv")

datos_2018<-data.frame(Indicativo=estaciones$INDICATIVO)
for (archivo in archivos_climaticos) {
  
    ruta_completa_archivo<-file.path(ruta_carpeta,archivo)
    
    variable <-read_delim(ruta_completa_archivo, delim = ";", escape_double = FALSE, trim_ws=TRUE, show_col_types=FALSE)
    
  prefijo <- substr(archivo, 1, 2)
  
  colnames(variable)[-1] <- paste(prefijo, colnames(variable)[-1], sep = "_")
    
  #colnames(variable)[-1] <- paste("p_", colnames(variable)[-1], sep = "")
  datos_variable<-as.data.frame(variable) 
  datos_2018<-merge(datos_2018,datos_variable, by="Indicativo", sort=FALSE,all.x = TRUE, all.y = TRUE)
}
```

```{r}
ruta_carpeta<-"data/Variables/2017"
archivos_climaticos <- list.files(ruta_carpeta,pattern = ".*.csv")

datos_2017<-data.frame(Indicativo=estaciones$INDICATIVO)
for (archivo in archivos_climaticos) {
  
    ruta_completa_archivo<-file.path(ruta_carpeta,archivo)
    
    variable <-read_delim(ruta_completa_archivo, delim = ";", escape_double = FALSE, trim_ws=TRUE, show_col_types=FALSE)
    
  prefijo <- substr(archivo, 1, 2)
  
  colnames(variable)[-1] <- paste(prefijo, colnames(variable)[-1], sep = "_")
    
  #colnames(variable)[-1] <- paste("p_", colnames(variable)[-1], sep = "")
  datos_variable<-as.data.frame(variable) 
  datos_2017<-merge(datos_2017,datos_variable, by="Indicativo", sort=FALSE,all.x = TRUE, all.y = TRUE)
}
```

```{r}
ruta_carpeta<-"data/Variables/2016"
archivos_climaticos <- list.files(ruta_carpeta,pattern = ".*.csv")

datos_2016<-data.frame(Indicativo=estaciones$INDICATIVO)
for (archivo in archivos_climaticos) {
  
    ruta_completa_archivo<-file.path(ruta_carpeta,archivo)
    
    variable <-read_delim(ruta_completa_archivo, delim = ";", escape_double = FALSE, trim_ws=TRUE, show_col_types=FALSE)
    
  prefijo <- substr(archivo, 1, 2)
  
  colnames(variable)[-1] <- paste(prefijo, colnames(variable)[-1], sep = "_")
    
  #colnames(variable)[-1] <- paste("p_", colnames(variable)[-1], sep = "")
  datos_variable<-as.data.frame(variable) 
  datos_2016<-merge(datos_2016,datos_variable, by="Indicativo", sort=FALSE,all.x = TRUE, all.y = TRUE)
}
```

